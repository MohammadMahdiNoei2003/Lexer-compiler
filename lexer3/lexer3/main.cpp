#include "lexer.hpp"

using namespace std;

int main() {
    unordered_map<int, unordered_map<char, int>> transitions = {
        {0, {{'a', 5},{'b', 5},{'c', 5},{'d', 5},{'e', 5},{'f', 2},{'g', 5},{'h', 5},{'i', 1},{'j', 5},{'k', 5},{'l', 5},{'m', 5},{'n', 5},{'o', 5},{'p', 5},{'q', 5},{'r', 5},{'s', 5},{'t', 5},{'u', 5},{'v', 5},{'w', 5},{'x', 5},{'y', 5},{'z', 5},{'A', 5},{'B', 5},{'C', 5},{'D', 5},{'E', 5},{'F', 5},{'G', 5},{'H', 5},{'I', 5},{'J', 5},{'K', 5},{'L', 5},{'M', 5},{'N', 5},{'O', 5},{'P', 5},{'Q', 5},{'R', 5},{'S', 5},{'T', 5},{'U', 5},{'V', 5},{'W', 5},{'X', 5},{'Y', 5},{'Z', 5}, {'(', 9}, {')', 12}, {'+', 8}, {'=', 10}, {'_', 5}, {'0', 7}, {'1', 7}, {'2', 7}, {'3', 7}, {'4', 7}, {'5', 7}, {'6', 7}, {'7', 7}, {'8', 7}, {'9', 7}}},

        {1, {{'a', 5},{'b', 5},{'c', 5},{'d', 5},{'e', 5},{'f', 6},{'g', 5},{'h', 5},{'i', 5},{'j', 5},{'k', 5},{'l', 5},{'m', 5},{'n', 5},{'o', 5},{'p', 5},{'q', 5},{'r', 5},{'s', 5},{'t', 5},{'u', 5},{'v', 5},{'w', 5},{'x', 5},{'y', 5},{'z', 5},{'A', 5},{'B', 5},{'C', 5},{'D', 5},{'E', 5},{'F', 5},{'G', 5},{'H', 5},{'I', 5},{'J', 5},{'K', 5},{'L', 5},{'M', 5},{'N', 5},{'O', 5},{'P', 5},{'Q', 5},{'R', 5},{'S', 5},{'T', 5},{'U', 5},{'V', 5},{'W', 5},{'X', 5},{'Y', 5},{'Z', 5}, {'_', 4}, {'0', 5}, {'1', 5}, {'2', 5}, {'3', 5}, {'4', 5}, {'5', 5}, {'6', 5}, {'7', 5}, {'8', 5}, {'9', 5}}},

        {2, {{'a', 5},{'b', 5},{'c', 5},{'d', 5},{'e', 5},{'f', 5},{'g', 5},{'h', 5},{'i', 5},{'j', 5},{'k', 5},{'l', 5},{'m', 5},{'n', 5},{'o', 3},{'p', 5},{'q', 5},{'r', 5},{'s', 5},{'t', 5},{'u', 5},{'v', 5},{'w', 5},{'x', 5},{'y', 5},{'z', 5},{'A', 5},{'B', 5},{'C', 5},{'D', 5},{'E', 5},{'F', 5},{'G', 5},{'H', 5},{'I', 5},{'J', 5},{'K', 5},{'L', 5},{'M', 5},{'N', 5},{'O', 5},{'P', 5},{'Q', 5},{'R', 5},{'S', 5},{'T', 5},{'U', 5},{'V', 5},{'W', 5},{'X', 5},{'Y', 5},{'Z', 5}, {'_', 4}, {'0', 5}, {'1', 5}, {'2', 5}, {'3', 5}, {'4', 5}, {'5', 5}, {'6', 5}, {'7', 5}, {'8', 5}, {'9', 5}}},

        {3, {{'a', 5},{'b', 5},{'c', 5},{'d', 5},{'e', 5},{'f', 5},{'g', 5},{'h', 5},{'i', 5},{'j', 5},{'k', 5},{'l', 5},{'m', 5},{'n', 5},{'o', 5},{'p', 5},{'q', 5},{'r', 6},{'s', 5},{'t', 5},{'u', 5},{'v', 5},{'w', 5},{'x', 5},{'y', 5},{'z', 5},{'A', 5},{'B', 5},{'C', 5},{'D', 5},{'E', 5},{'F', 5},{'G', 5},{'H', 5},{'I', 5},{'J', 5},{'K', 5},{'L', 5},{'M', 5},{'N', 5},{'O', 5},{'P', 5},{'Q', 5},{'R', 5},{'S', 5},{'T', 5},{'U', 5},{'V', 5},{'W', 5},{'X', 5},{'Y', 5},{'Z', 5}, {'_', 4}, {'0', 5}, {'1', 5}, {'2', 5}, {'3', 5}, {'4', 5}, {'5', 5}, {'6', 5}, {'7', 5}, {'8', 5}, {'9', 5}}},

        {4, {{'a', 5},{'b', 5},{'c', 5},{'d', 5},{'e', 5},{'f', 5},{'g', 5},{'h', 5},{'i', 5},{'j', 5},{'k', 5},{'l', 5},{'m', 5},{'n', 5},{'o', 5},{'p', 5},{'q', 5},{'r', 5},{'s', 5},{'t', 5},{'u', 5},{'v', 5},{'w', 5},{'x', 5},{'y', 5},{'z', 5},{'A', 5},{'B', 5},{'C', 5},{'D', 5},{'E', 5},{'F', 5},{'G', 5},{'H', 5},{'I', 5},{'J', 5},{'K', 5},{'L', 5},{'M', 5},{'N', 5},{'O', 5},{'P', 5},{'Q', 5},{'R', 5},{'S', 5},{'T', 5},{'U', 5},{'V', 5},{'W', 5},{'X', 5},{'Y', 5},{'Z', 5}, {'_', 4}, {'0', 5}, {'1', 5}, {'2', 5}, {'3', 5}, {'4', 5}, {'5', 5}, {'6', 5}, {'7', 5}, {'8', 5}, {'9', 5}}},

        {5, {{'a', 5},{'b', 5},{'c', 5},{'d', 5},{'e', 5},{'f', 5},{'g', 5},{'h', 5},{'i', 5},{'j', 5},{'k', 5},{'l', 5},{'m', 5},{'n', 5},{'o', 5},{'p', 5},{'q', 5},{'r', 5},{'s', 5},{'t', 5},{'u', 5},{'v', 5},{'w', 5},{'x', 5},{'y', 5},{'z', 5},{'A', 5},{'B', 5},{'C', 5},{'D', 5},{'E', 5},{'F', 5},{'G', 5},{'H', 5},{'I', 5},{'J', 5},{'K', 5},{'L', 5},{'M', 5},{'N', 5},{'O', 5},{'P', 5},{'Q', 5},{'R', 5},{'S', 5},{'T', 5},{'U', 5},{'V', 5},{'W', 5},{'X', 5},{'Y', 5},{'Z', 5}, {'_', 4}, {'0', 5}, {'1', 5}, {'2', 5}, {'3', 5}, {'4', 5}, {'5', 5}, {'6', 5}, {'7', 5}, {'8', 5}, {'9', 5}}},

        {6, {{'a', 5},{'b', 5},{'c', 5},{'d', 5},{'e', 5},{'f', 5},{'g', 5},{'h', 5},{'i', 5},{'j', 5},{'k', 5},{'l', 5},{'m', 5},{'n', 5},{'o', 5},{'p', 5},{'q', 5},{'r', 5},{'s', 5},{'t', 5},{'u', 5},{'v', 5},{'w', 5},{'x', 5},{'y', 5},{'z', 5},{'A', 5},{'B', 5},{'C', 5},{'D', 5},{'E', 5},{'F', 5},{'G', 5},{'H', 5},{'I', 5},{'J', 5},{'K', 5},{'L', 5},{'M', 5},{'N', 5},{'O', 5},{'P', 5},{'Q', 5},{'R', 5},{'S', 5},{'T', 5},{'U', 5},{'V', 5},{'W', 5},{'X', 5},{'Y', 5},{'Z', 5}, {'_', 4}, {'0', 5}, {'1', 5}, {'2', 5}, {'3', 5}, {'4', 5}, {'5', 5}, {'6', 5}, {'7', 5}, {'8', 5}, {'9', 5}}},

        {7, {{'a', 11},{'b', 11},{'c', 11},{'d', 11},{'e', 11},{'f', 11},{'g', 11},{'h', 11},{'i', 11},{'j', 11},{'k', 11},{'l', 11},{'m', 11},{'n', 11},{'o', 11},{'p', 11},{'q', 11},{'r', 11},{'s', 11},{'t', 11},{'u', 11},{'v', 11},{'w', 11},{'x', 11},{'y', 11},{'z', 11},{'A', 11},{'B', 11},{'C', 11},{'D', 11},{'E', 11},{'F', 11},{'G', 11},{'H', 11},{'I', 11},{'J', 11},{'K', 11},{'L', 11},{'M', 11},{'N', 11},{'O', 11},{'P', 11},{'Q', 11},{'R', 11},{'S', 11},{'T', 11},{'U', 11},{'V', 11},{'W', 11},{'X', 11},{'Y', 11},{'Z', 11}, {'_', 11}, {'0', 7}, {'1', 7}, {'2', 7}, {'3', 7}, {'4', 7}, {'5', 7}, {'6', 7}, {'7', 7}, {'8', 7}, {'9', 7}}},

        {11, {{'a', 11},{'b', 11},{'c', 11},{'d', 11},{'e', 11},{'f', 11},{'g', 11},{'h', 11},{'i', 11},{'j', 11},{'k', 11},{'l', 11},{'m', 11},{'n', 11},{'o', 11},{'p', 11},{'q', 11},{'r', 11},{'s', 11},{'t', 11},{'u', 11},{'v', 11},{'w', 11},{'x', 11},{'y', 11},{'z', 11},{'A', 11},{'B', 11},{'C', 11},{'D', 11},{'E', 11},{'F', 11},{'G', 11},{'H', 11},{'I', 11},{'J', 11},{'K', 11},{'L', 11},{'M', 11},{'N', 11},{'O', 11},{'P', 11},{'Q', 11},{'R', 11},{'S', 11},{'T', 11},{'U', 11},{'V', 11},{'W', 11},{'X', 11},{'Y', 11},{'Z', 11}, {'_', 11}, {'0', 11}, {'1', 11}, {'2', 11}, {'3', 11}, {'4', 11}, {'5', 11}, {'6', 11}, {'7', 11}, {'8', 11}, {'9', 11},{'+', 11},{'=', 11},{'(', 11},{')', 11}}},

    };

    unordered_set<int> acceptingStates = {1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12}; 
    unordered_map<int, TokenType> tokenTypes = {
        {1, IDENTIFIER},
        {2, IDENTIFIER},
        {3, IDENTIFIER},
        {5, IDENTIFIER},
        {4, IDENTIFIER},
        {6, KEYWORD_IF}, 
        {6, KEYWORD_FOR}, 
        {7, INTEGER}, 
        {8, OPERATOR_PLUS}, 
        {10, OPERATOR_EQUALS}, 
        {9, PAREN_OPEN}, 
        {12, PAREN_CLOSE},
        {11, ERROR}
    };


    DFA dfa(0, acceptingStates, transitions, tokenTypes);

    string input = "if (_20_ = 10 + y) for (z = 20x)";
    // string input = "_20 = 2x for ( if+for (_20 = a) a += a )";
    vector<Token> tokens = lexer(input, dfa);
    printTokens(tokens);

    return 0;
}